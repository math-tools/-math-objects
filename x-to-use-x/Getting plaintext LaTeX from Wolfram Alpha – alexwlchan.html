<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Getting plaintext LaTeX from Wolfram Alpha – alexwlchan</title> <meta name="description" content="Alex Chan's personal blog"> <link rel="canonical" href="https://alexwlchan.net/2014/07/latex-alpha/"> <link type="application/atom+xml" rel="alternate" href="https://alexwlchan.net/atom.xml"> <!-- Page source: https://github.com/alexwlchan/alexwlchan.net/blob/live/src/_posts/2014/2014-07-11-latex-alpha.md --> <link rel="stylesheet" href="Getting%20plaintext%20LaTeX%20from%20Wolfram%20Alpha%20%E2%80%93%20alexwlchan_fichiers/style.css"> <link rel="shortcut icon" type="image/png" href="https://alexwlchan.net/theme/favicon.png"> <link rel="shortcut icon" type="image/x-icon" href="https://alexwlchan.net/theme/favicon.ico"> <link rel="apple-touch-icon" href="https://alexwlchan.net/theme/apple-touch-icon.png"> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@alexwlchan"> <meta name="twitter:title" content="Getting plaintext LaTeX from Wolfram Alpha"> <meta name="twitter:image" content="https://alexwlchan.net/images/profile2020.jpg"> <meta property="og:image" content="https://alexwlchan.net/images/profile2020.jpg"> <meta property="og:type" content="article"> <meta property="og:url" content="https://alexwlchan.net/2014/07/latex-alpha/"> <meta property="og:title" content="Getting plaintext LaTeX from Wolfram Alpha"> </head> <body data-new-gr-c-s-check-loaded="8.868.0" data-gr-ext-installed=""> <aside> <div id="aside_inner"> <h1 id="brand"><a href="https://alexwlchan.net/">alexwlchan</a></h1> <div id="aside_links"> <ul class="dot_list"> <li><a href="https://alexwlchan.net/best-of/">favourite posts</a></li> <li><a href="https://alexwlchan.net/all-posts/">all posts</a></li> <li><a href="https://alexwlchan.net/talks/">talks</a></li> <li><a href="https://twitter.com/alexwlchan/">twitter</a></li> <li><a href="https://alexwlchan.net/atom.xml">rss</a></li> </ul> </div> </div> </aside> <article class="post"> <h1 class="title post__title"> <a href="https://alexwlchan.net/2014/07/latex-alpha/"> Getting plaintext <span class="latex">L<sup>a</sup>T<sub>e</sub>X</span> from Wolfram Alpha</a> </h1> <div class="post__meta"> <ul class="dot_list"> <li class="post__date"> Posted 11 July 2014 </li> <li class="post__tags"> Tagged with <a href="https://alexwlchan.net/all-posts-by-tag#latex">latex</a>, <a href="https://alexwlchan.net/all-posts-by-tag#wolfram-alpha">wolfram-alpha</a> </li> </ul> </div> <p>Although I don’t write numerical equations very often, I couldn’t help but smile at <a href="http://www.leancrew.com/all-this/2014/07/evaluating-latex-with-eddie-and-alpha/">this post by Dr. Drang</a>. Building on <a href="http://www.practicallyefficient.com/home/2014/7/10/latex-alfred-wolfram">a post by Eddie Smith</a> which shows how to use WolframAlpha to evaluate a <span class="latex">L<sup>a</sup>T<sub>e</sub>X</span>
 expression for a numerical answer, he shows off a way to automate 
getting the equation from BBEdit, to save a tedious copy/paste step. 
Read their posts before you carry on.</p> <p>Dr. Drang’s script gets the <span class="latex">L<sup>a</sup>T<sub>e</sub>X</span>
 equation out of BBEdit and loads Wolfram Alpha, but you still need to 
click the “Copyable plaintext” link. He ended the post as follows:</p> <blockquote> <p>What
 I’d really like is to automate the copying and pasting of the answer. 
Wolfram’s page structure doesn’t make that easy, but it’s something I 
want to explore.</p> </blockquote> <p>I tried to parse the Wolfram Alpha page structure in the past, and it was a bit of a mess. It’s much easier to use the <a href="http://products.wolframalpha.com/api/">Wolfram Alpha Developer API</a>, which provides this very easily. I think I can use this to get the final piece.</p> <!-- summary --> <p>If you don’t already have a (free) Wolfram ID, then <a href="https://developer.wolframalpha.com/portal/apisignup.html">signing up for one</a> takes about a minute. Then you can register an API key, and make queries in the form</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://api.wolframalpha.com/v2/query?input=\pi&amp;appid=XXXXXX-YYYYYYYYYY
</code></pre></div></div> <p>rather than going to the website. This 
returns an XML object with your results, which saves you unpicking the 
page structure yourself.</p> <p>The Wolfram Alpha output is divided into
 “pods” (which correspond roughly to the rectangles in the web output), 
and we can pick out the pod which gives the decimal representation of an
 expression. Within this pod, the <code class="highlighter-rouge">plaintext</code> key gives us the text we’d get from the “Copyable plaintext” link. That’s what we want.</p> <p>I’ve wrapped this in a script, which incorporates part of what Dr. Drang wrote:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">quote_plus</span>
<span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="k">as</span> <span class="n">ET</span>

<span class="n">appid</span> <span class="o">=</span> <span class="s">'XXXXXX-YYYYYYYYYY'</span>

<span class="k">def</span> <span class="nf">get_plaintext_query</span><span class="p">(</span><span class="n">latex</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'http://api.wolframalpha.com/v2/query?input=</span><span class="si">%</span><span class="s">s&amp;appid=</span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="p">(</span><span class="n">quote_plus</span><span class="p">(</span><span class="n">latex</span><span class="p">),</span> <span class="n">appid</span><span class="p">))</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf8'</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">pod</span> <span class="ow">in</span> <span class="n">root</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pod</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'title'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'Decimal approximation'</span><span class="p">,</span> <span class="s">'Definite integral'</span><span class="p">]:</span>
            <span class="n">subpod</span> <span class="o">=</span> <span class="n">pod</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">'subpod'</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">subpod</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">'plaintext'</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

            <span class="k">if</span> <span class="n">pod</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'title'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span> <span class="o">==</span> <span class="s">'Definite integral'</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'~~'</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">result</span>

    <span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">stdin</span>
        <span class="k">print</span> <span class="n">get_plaintext_query</span><span class="p">(</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</code></pre></div></div> <p>You’ll need to add your own App ID in line 8. The URL encoding is handled by <code class="highlighter-rouge">quote_plus</code>, taken from Dr. Drang’s script, and then <code class="highlighter-rouge">ElementTree</code> handles the XML decoding.</p> <p>It takes a few seconds to run, but it’s still faster than opening a web page and doing the copy/paste yourself.</p> <p>Right now it evaluates raw expressions, such as <code class="highlighter-rouge">\frac{\pi + \sqrt{3}}{\exp(2)}</code>, and definite integrals, such as <code class="highlighter-rouge">\int_0^5 x^2 dx</code>. There may be other forms of input for which this is useful, but I couldn’t think of them when I wrote this.</p> <p>If
 we have the plaintext number in a script, then we can also do some nice
 formatting. For example, if we’re working with currency units, then we 
might want to trim all but the last two decimal places:</p><pre><code class="language-pycon">&gt;&gt;&gt; x = get_plaintext_query('\pi')
3.1415926535897932384626433832795028841971693993751058...
&gt;&gt;&gt; y = eval(x.replace('...', ''))
&gt;&gt;&gt; round(y, 2)
3.14
</code></pre><p>Alternatively, I remember in school being told to round 
to a particular number of significant figures. Here’s a quick function 
for rounding to significant figures:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_sig_figs</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">div</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span> <span class="o">/</span> <span class="n">div</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">div</span> <span class="o">*=</span> <span class="mi">10</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">num</span> <span class="o">/</span> <span class="n">div</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">div</span>
</code></pre></div></div> <p>And there are probably plenty of other 
things you could do with this. But since I don’t work with this sort of 
numerical equation on a regular basis (yet), I don’t know how useful 
this would actually be, so I think I’ll just stop there.</p> <p>This 
script won’t work every time. Complicated expressions will probably 
still need a trip to Wolfram Alpha to check that it’s been interpreted 
correctly, or if you need a different part of the output. But for simple
 stuff, this should be fine.</p> </article> <footer> <div id="footer_inner"> <p> Copyright © 2012–21 Alex Chan. Prose is <a id="footer__cc" href="https://creativecommons.org/licenses/by/4.0/">CC-BY</a> licensed, code is <a id="footer__mit" href="https://github.com/alexwlchan/alexwlchan.net/blob/9a80d17de47b130772bb5433592e8fffd1d18118/LICENSE">MIT</a>. <a href="https://alexwlchan.net/about-the-site/" id="footer__about">About the site</a>. </p> <p> If you like my writing, perhaps <a href="https://alexwlchan.net/say-thanks/">say thanks</a>? </p> <div id="contact_links"> Get in touch:&nbsp; <ul class="dot_list"> <li><a id="footer__email" href="mailto:alex@alexwlchan.net">email</a></li> <li><a id="footer__github" href="https://github.com/alexwlchan">github</a></li> <li><a id="footer__twitter" href="https://twitter.com/alexwlchan">twitter</a></li> </ul> </div> </div> </footer> <script src="Getting%20plaintext%20LaTeX%20from%20Wolfram%20Alpha%20%E2%80%93%20alexwlchan_fichiers/a.js" type="text/javascript"></script>  
</body></html>